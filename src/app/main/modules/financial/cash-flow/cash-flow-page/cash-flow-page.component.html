<div class="mr-5 ml-5 mt-3">
  <form [formGroup]="filterForm"
        (ngSubmit)="onSubmit()"
        class="mt-4"
        fxLayout="row"
        fxLayoutAlign="start center"
        fxLayoutGap="gappx">

    <div class="pos-relative"
         fxFlex="30%">
      <app-cfc-autocomplete class="auto-complete"
                            formControlName="cfc"
                            [fControl]="filterForm.controls.cfc">
      </app-cfc-autocomplete>
    </div>

    <mat-form-field appearance="outline"
                    class="mr-3">
      <mat-label>DATA INICIO</mat-label>
      <input matInput
             [matDatepicker]="picker"
             formControlName="initialDate">
      <mat-datepicker-toggle matSuffix
                             [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker></mat-datepicker>
    </mat-form-field>

    <mat-form-field appearance="outline"
                    class="mr-3">
      <mat-label>DATA FIM</mat-label>
      <input matInput
             [matDatepicker]="picker2"
             formControlName="finalDate">
      <mat-datepicker-toggle matSuffix
                             [for]="picker2"></mat-datepicker-toggle>
      <mat-datepicker #picker2></mat-datepicker>
    </mat-form-field>

    <button class="mr-3"
            mat-raised-button
            color="primary"
            type="submit">LISTAR</button>
  </form>

  <mat-tab-group>
    <mat-tab label="PREVISTO - TOTAL {{total | currency: 'BRL':'R$'}}">
      <div class="mt-5 cash-flow-table">
        <table mat-table
               [dataSource]="dataSource"
               class="mat-elevation-z8"
               *ngIf="dataSource?.data?.length > 0; else noData">

          <ng-container matColumnDef="description">
            <th mat-header-cell
                *matHeaderCellDef> Descrição </th>
            <td mat-cell
                *matCellDef="let element"> {{element.tipoLancamento.descricao}} </td>
          </ng-container>

          <ng-container matColumnDef="paymentDate">
            <th mat-header-cell
                *matHeaderCellDef> Data de Pagamento </th>
            <td mat-cell
                *matCellDef="let element"> {{element.dataPagamento | date: 'dd/MM/yyyy'}} </td>
          </ng-container>

          <ng-container matColumnDef="validDate">
            <th mat-header-cell
                *matHeaderCellDef> Data de Vencimento </th>
            <td mat-cell
                *matCellDef="let element"> {{element.dataVencimento | date: 'dd/MM/yyyy'}} </td>
          </ng-container>

          <ng-container matColumnDef="type">
            <th mat-header-cell
                *matHeaderCellDef
                class="cash-flow-table__cell--center"> Tipo </th>
            <td mat-cell
                *matCellDef="let element"
                class="cash-flow-table__cell--center">
              <div [class]="'cash-flow-table__status cash-flow-table__status--' + element.tipoLancamento.tipo">

                {{ element.tipoLancamento.tipo === 'CB' ? 'RECEITA': '' }}

                {{ element.tipoLancamento.tipo === 'DB' ? 'DESPESA': '' }}
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="value">
            <th mat-header-cell
                *matHeaderCellDef> Valor (R$)</th>
            <td mat-cell
                *matCellDef="let element"> {{element.valor | currency : 'BRL'}} </td>
          </ng-container>

          <tr mat-header-row
              *matHeaderRowDef="displayedColumns; sticky: true"></tr>
          <tr mat-row
              *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
    </mat-tab>
    <mat-tab label="PREVISTO - TOTAL {{totalVenciment | currency: 'BRL':'R$'}}">
      <div class="mt-5 cash-flow-table">
        <table mat-table
               [dataSource]="dataSourceLate"
               class="mat-elevation-z8"
               *ngIf="dataSourceLate?.data?.length > 0; else noData">

          <ng-container matColumnDef="description">
            <th mat-header-cell
                *matHeaderCellDef> Descrição </th>
            <td mat-cell
                *matCellDef="let element"> {{element.tipoLancamento.descricao}} </td>
          </ng-container>

          <ng-container matColumnDef="paymentDate">
            <th mat-header-cell
                *matHeaderCellDef> Data de Pagamento </th>
            <td mat-cell
                *matCellDef="let element"> {{element.dataPagamento | date: 'dd/MM/yyyy'}} </td>
          </ng-container>

          <ng-container matColumnDef="validDate">
            <th mat-header-cell
                *matHeaderCellDef> Data de Vencimento </th>
            <td mat-cell
                *matCellDef="let element"> {{element.dataVencimento | date: 'dd/MM/yyyy'}} </td>
          </ng-container>

          <ng-container matColumnDef="type">
            <th mat-header-cell
                *matHeaderCellDef
                class="cash-flow-table__cell--center"> Tipo </th>
            <td mat-cell
                *matCellDef="let element"
                class="cash-flow-table__cell--center">
              <div [class]="'cash-flow-table__status cash-flow-table__status--' + element.tipoLancamento.tipo">

                {{ element.tipoLancamento.tipo === 'CB' ? 'A RECEBER': '' }}

                {{ element.tipoLancamento.tipo === 'DB' ? 'A PAGAR': '' }}
              </div>
            </td>
          </ng-container>

          <ng-container matColumnDef="value">
            <th mat-header-cell
                *matHeaderCellDef> Valor (R$)</th>
            <td mat-cell
                *matCellDef="let element"> {{element.valor | currency : 'BRL'}} </td>
          </ng-container>

          <tr mat-header-row
              *matHeaderRowDef="displayedColumns; sticky: true"></tr>
          <tr mat-row
              *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
    </mat-tab>
  </mat-tab-group>
</div>

<ng-template #noData>
  <ng-container>
    <div class="txt-center">
      Preencha o campos e clique em LISTAR.
    </div>
  </ng-container>
</ng-template>
